2025-12-12 13:51:32,253   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 13:51:32,253   INFO  seq_len=8, stride=4
2025-12-12 13:51:32,319   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 13:51:32,319   INFO  Database filter by min points truck: 451 => 412
2025-12-12 13:51:32,319   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 13:51:32,319   INFO  Database filter by min points bus: 337 => 309
2025-12-12 13:51:32,319   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 13:51:32,319   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 13:51:32,320   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 13:51:32,320   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 13:51:32,320   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 13:51:32,320   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 13:51:32,320   INFO  Loading NuScenes dataset
2025-12-12 13:51:32,335   INFO  Total samples for NuScenes dataset: 323
2025-12-12 13:51:32,338   INFO  Total samples after balanced resampling: 1630
2025-12-12 13:51:33,796   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 13:51:55,080   INFO  epoch 1/2, seq 10/397, total_loss 5.1038, cls 1.1233, loc 3.9805, lr 3.000000e-03
2025-12-12 13:52:08,821   INFO  epoch 1/2, seq 20/397, total_loss 2.1827, cls 1.0397, loc 1.1429, lr 3.000000e-03
2025-12-12 14:30:46,293   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:30:46,293   INFO  seq_len=8, stride=4
2025-12-12 14:30:46,355   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:30:46,355   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:30:46,355   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:30:46,355   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:30:46,355   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:30:46,356   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:30:46,356   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:30:46,356   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:30:46,356   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:30:46,356   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:30:46,357   INFO  Loading NuScenes dataset
2025-12-12 14:30:46,372   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:30:46,375   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:30:47,853   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:33:16,534   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:33:16,534   INFO  seq_len=8, stride=4
2025-12-12 14:33:16,595   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:33:16,595   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:33:16,595   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:33:16,595   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:33:16,595   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:33:16,595   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:33:16,595   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:33:16,595   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:33:16,596   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:33:16,596   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:33:16,596   INFO  Loading NuScenes dataset
2025-12-12 14:33:16,611   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:33:16,614   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:33:18,074   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:39:51,999   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:39:51,999   INFO  seq_len=8, stride=4
2025-12-12 14:39:52,062   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:39:52,062   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:39:52,062   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:39:52,063   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:39:52,063   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:39:52,063   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:39:52,063   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:39:52,063   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:39:52,063   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:39:52,063   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:39:52,064   INFO  Loading NuScenes dataset
2025-12-12 14:39:52,078   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:39:52,081   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:39:53,550   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:43:29,913   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:43:29,913   INFO  seq_len=8, stride=4
2025-12-12 14:43:29,977   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:43:29,977   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:43:29,977   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:43:29,977   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:43:29,977   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:43:29,977   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:43:29,977   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:43:29,977   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:43:29,978   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:43:29,978   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:43:29,978   INFO  Loading NuScenes dataset
2025-12-12 14:43:29,994   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:43:29,996   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:43:31,492   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:44:56,324   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:44:56,324   INFO  seq_len=8, stride=4
2025-12-12 14:44:56,386   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:44:56,386   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:44:56,386   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:44:56,386   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:44:56,386   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:44:56,386   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:44:56,386   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:44:56,386   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:44:56,386   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:44:56,387   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:44:56,387   INFO  Loading NuScenes dataset
2025-12-12 14:44:56,402   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:44:56,404   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:44:57,902   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:47:46,039   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:47:46,039   INFO  seq_len=8, stride=4
2025-12-12 14:47:46,102   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:47:46,102   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:47:46,102   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:47:46,102   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:47:46,102   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:47:46,102   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:47:46,102   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:47:46,102   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:47:46,103   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:47:46,103   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:47:46,103   INFO  Loading NuScenes dataset
2025-12-12 14:47:46,118   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:47:46,120   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:47:47,589   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:49:18,647   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:49:18,648   INFO  seq_len=8, stride=4
2025-12-12 14:49:18,709   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:49:18,709   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:49:18,709   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:49:18,709   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:49:18,709   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:49:18,710   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:49:18,710   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:49:18,710   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:49:18,710   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:49:18,710   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:49:18,711   INFO  Loading NuScenes dataset
2025-12-12 14:49:18,726   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:49:18,728   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:49:20,195   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:50:38,750   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 2, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:50:38,750   INFO  seq_len=8, stride=4
2025-12-12 14:50:38,813   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:50:38,813   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:50:38,813   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:50:38,813   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:50:38,813   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:50:38,813   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:50:38,813   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:50:38,813   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:50:38,814   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:50:38,814   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:50:38,814   INFO  Loading NuScenes dataset
2025-12-12 14:50:38,829   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:50:38,832   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:50:40,356   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:52:08,356   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:52:08,356   INFO  seq_len=8, stride=4
2025-12-12 14:52:08,411   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:52:08,412   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:52:08,412   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:52:08,412   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:52:08,412   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:52:08,412   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:52:08,412   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:52:08,412   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:52:08,412   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:52:08,412   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:52:08,413   INFO  Loading NuScenes dataset
2025-12-12 14:52:08,429   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:52:08,432   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:52:09,967   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:52:24,566   INFO  epoch 1/20, seq 10/396, total_loss 5.4673, cls 1.1261, loc 4.3412, lr 3.000000e-03
2025-12-12 14:52:34,892   INFO  epoch 1/20, seq 20/396, total_loss 2.1928, cls 1.0910, loc 1.1019, lr 3.000000e-03
2025-12-12 14:52:45,387   INFO  epoch 1/20, seq 30/396, total_loss 1.8529, cls 1.0030, loc 0.8499, lr 3.000000e-03
2025-12-12 14:52:55,705   INFO  epoch 1/20, seq 40/396, total_loss 1.6040, cls 0.9064, loc 0.6976, lr 3.000000e-03
2025-12-12 14:53:05,294   INFO  epoch 1/20, seq 50/396, total_loss 1.6554, cls 0.9313, loc 0.7242, lr 3.000000e-03
2025-12-12 14:53:15,357   INFO  epoch 1/20, seq 60/396, total_loss 1.6766, cls 0.8964, loc 0.7802, lr 3.000000e-03
2025-12-12 14:53:25,305   INFO  epoch 1/20, seq 70/396, total_loss 1.6353, cls 0.9489, loc 0.6864, lr 3.000000e-03
2025-12-12 14:53:35,478   INFO  epoch 1/20, seq 80/396, total_loss 1.5982, cls 0.8999, loc 0.6983, lr 3.000000e-03
2025-12-12 14:53:45,521   INFO  epoch 1/20, seq 90/396, total_loss 1.4756, cls 0.8411, loc 0.6345, lr 3.000000e-03
2025-12-12 14:53:55,460   INFO  epoch 1/20, seq 100/396, total_loss 1.5143, cls 0.8535, loc 0.6609, lr 3.000000e-03
2025-12-12 14:54:05,451   INFO  epoch 1/20, seq 110/396, total_loss 1.5352, cls 0.8563, loc 0.6790, lr 3.000000e-03
2025-12-12 14:54:15,226   INFO  epoch 1/20, seq 120/396, total_loss 1.6674, cls 0.9161, loc 0.7513, lr 3.000000e-03
2025-12-12 14:54:25,434   INFO  epoch 1/20, seq 130/396, total_loss 1.6301, cls 0.9380, loc 0.6921, lr 3.000000e-03
2025-12-12 14:54:35,055   INFO  epoch 1/20, seq 140/396, total_loss 1.4124, cls 0.8249, loc 0.5874, lr 3.000000e-03
2025-12-12 14:54:45,158   INFO  epoch 1/20, seq 150/396, total_loss 1.5924, cls 0.9416, loc 0.6508, lr 3.000000e-03
2025-12-12 14:54:55,273   INFO  epoch 1/20, seq 160/396, total_loss 1.4116, cls 0.8126, loc 0.5990, lr 3.000000e-03
2025-12-12 14:55:05,539   INFO  epoch 1/20, seq 170/396, total_loss 1.5525, cls 0.9265, loc 0.6260, lr 3.000000e-03
2025-12-12 14:55:15,557   INFO  epoch 1/20, seq 180/396, total_loss 1.6128, cls 0.8803, loc 0.7325, lr 3.000000e-03
2025-12-12 14:55:25,761   INFO  epoch 1/20, seq 190/396, total_loss 1.4502, cls 0.8534, loc 0.5968, lr 3.000000e-03
2025-12-12 14:55:35,854   INFO  epoch 1/20, seq 200/396, total_loss 1.5353, cls 0.8403, loc 0.6949, lr 3.000000e-03
2025-12-12 14:56:26,413   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-12 14:56:26,413   INFO  seq_len=8, stride=4
2025-12-12 14:56:26,469   INFO  Database filter by min points car: 4082 => 3303
2025-12-12 14:56:26,469   INFO  Database filter by min points truck: 451 => 412
2025-12-12 14:56:26,469   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-12 14:56:26,469   INFO  Database filter by min points bus: 337 => 309
2025-12-12 14:56:26,469   INFO  Database filter by min points trailer: 59 => 57
2025-12-12 14:56:26,469   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-12 14:56:26,469   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-12 14:56:26,469   INFO  Database filter by min points bicycle: 147 => 136
2025-12-12 14:56:26,469   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-12 14:56:26,469   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-12 14:56:26,470   INFO  Loading NuScenes dataset
2025-12-12 14:56:26,485   INFO  Total samples for NuScenes dataset: 323
2025-12-12 14:56:26,487   INFO  Total samples after balanced resampling: 1630
2025-12-12 14:56:27,979   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-12 14:57:22,005   INFO  epoch 1/20, seq 50/396, total_loss 1.5409, cls 0.8683, loc 0.6726, lr 3.000000e-03
2025-12-12 14:58:12,388   INFO  epoch 1/20, seq 100/396, total_loss 1.5547, cls 0.8770, loc 0.6777, lr 3.000000e-03
2025-12-12 14:59:02,440   INFO  epoch 1/20, seq 150/396, total_loss 1.5233, cls 0.8541, loc 0.6691, lr 3.000000e-03
2025-12-12 14:59:52,843   INFO  epoch 1/20, seq 200/396, total_loss 1.4030, cls 0.8168, loc 0.5862, lr 3.000000e-03
2025-12-12 15:00:42,359   INFO  epoch 1/20, seq 250/396, total_loss 1.4951, cls 0.8177, loc 0.6775, lr 3.000000e-03
2025-12-12 15:01:32,688   INFO  epoch 1/20, seq 300/396, total_loss 1.6203, cls 0.8865, loc 0.7338, lr 3.000000e-03
2025-12-12 15:02:23,726   INFO  epoch 1/20, seq 350/396, total_loss 1.4371, cls 0.7893, loc 0.6478, lr 3.000000e-03
2025-12-12 15:03:08,697   INFO  Saved checkpoint to log/ckpt_epoch_1.pth
2025-12-12 15:04:02,433   INFO  epoch 2/20, seq 50/396, total_loss 1.3756, cls 0.7992, loc 0.5764, lr 3.000000e-03
2025-12-12 15:04:52,423   INFO  epoch 2/20, seq 100/396, total_loss 1.3971, cls 0.7614, loc 0.6357, lr 3.000000e-03
2025-12-12 15:05:44,648   INFO  epoch 2/20, seq 150/396, total_loss 1.3490, cls 0.7879, loc 0.5611, lr 3.000000e-03
2025-12-12 15:06:36,993   INFO  epoch 2/20, seq 200/396, total_loss 1.2551, cls 0.6831, loc 0.5721, lr 3.000000e-03
2025-12-12 15:07:28,979   INFO  epoch 2/20, seq 250/396, total_loss 1.2830, cls 0.7042, loc 0.5788, lr 3.000000e-03
2025-12-12 15:08:21,987   INFO  epoch 2/20, seq 300/396, total_loss 1.3860, cls 0.7889, loc 0.5971, lr 3.000000e-03
2025-12-12 15:09:14,845   INFO  epoch 2/20, seq 350/396, total_loss 1.3002, cls 0.7450, loc 0.5552, lr 3.000000e-03
2025-12-12 15:10:02,321   INFO  Saved checkpoint to log/ckpt_epoch_2.pth
2025-12-12 15:10:57,582   INFO  epoch 3/20, seq 50/396, total_loss 1.1507, cls 0.6793, loc 0.4714, lr 3.000000e-03
2025-12-12 15:11:49,128   INFO  epoch 3/20, seq 100/396, total_loss 1.3036, cls 0.7577, loc 0.5459, lr 3.000000e-03
2025-12-12 15:12:40,956   INFO  epoch 3/20, seq 150/396, total_loss 1.3457, cls 0.7907, loc 0.5550, lr 3.000000e-03
2025-12-12 15:13:32,271   INFO  epoch 3/20, seq 200/396, total_loss 1.0970, cls 0.6335, loc 0.4635, lr 3.000000e-03
2025-12-12 15:14:24,556   INFO  epoch 3/20, seq 250/396, total_loss 1.1876, cls 0.6658, loc 0.5218, lr 3.000000e-03
2025-12-12 15:15:17,443   INFO  epoch 3/20, seq 300/396, total_loss 1.0812, cls 0.5964, loc 0.4848, lr 3.000000e-03
2025-12-12 15:16:10,373   INFO  epoch 3/20, seq 350/396, total_loss 1.2634, cls 0.6704, loc 0.5930, lr 3.000000e-03
2025-12-12 15:16:58,688   INFO  Saved checkpoint to log/ckpt_epoch_3.pth
2025-12-12 15:17:55,299   INFO  epoch 4/20, seq 50/396, total_loss 1.3173, cls 0.7340, loc 0.5832, lr 3.000000e-03
2025-12-12 15:18:48,902   INFO  epoch 4/20, seq 100/396, total_loss 1.2310, cls 0.6928, loc 0.5382, lr 3.000000e-03
2025-12-12 15:19:41,233   INFO  epoch 4/20, seq 150/396, total_loss 0.9967, cls 0.5204, loc 0.4763, lr 3.000000e-03
2025-12-12 15:20:34,667   INFO  epoch 4/20, seq 200/396, total_loss 1.2337, cls 0.6791, loc 0.5546, lr 3.000000e-03
2025-12-12 15:21:27,740   INFO  epoch 4/20, seq 250/396, total_loss 1.1231, cls 0.5863, loc 0.5368, lr 3.000000e-03
2025-12-12 15:22:21,484   INFO  epoch 4/20, seq 300/396, total_loss 0.9712, cls 0.5440, loc 0.4272, lr 3.000000e-03
2025-12-12 15:23:14,122   INFO  epoch 4/20, seq 350/396, total_loss 0.9346, cls 0.4803, loc 0.4543, lr 3.000000e-03
2025-12-12 15:24:03,110   INFO  Saved checkpoint to log/ckpt_epoch_4.pth
2025-12-12 15:24:59,863   INFO  epoch 5/20, seq 50/396, total_loss 0.9528, cls 0.4927, loc 0.4601, lr 3.000000e-03
2025-12-12 15:25:52,930   INFO  epoch 5/20, seq 100/396, total_loss 1.0499, cls 0.5914, loc 0.4585, lr 3.000000e-03
2025-12-12 15:26:45,767   INFO  epoch 5/20, seq 150/396, total_loss 0.9828, cls 0.5700, loc 0.4129, lr 3.000000e-03
2025-12-12 15:27:38,981   INFO  epoch 5/20, seq 200/396, total_loss 0.8384, cls 0.4269, loc 0.4115, lr 3.000000e-03
2025-12-12 15:28:31,956   INFO  epoch 5/20, seq 250/396, total_loss 1.1527, cls 0.6315, loc 0.5212, lr 3.000000e-03
2025-12-12 15:29:25,189   INFO  epoch 5/20, seq 300/396, total_loss 1.1384, cls 0.5924, loc 0.5460, lr 3.000000e-03
2025-12-12 15:30:19,427   INFO  epoch 5/20, seq 350/396, total_loss 0.8814, cls 0.4597, loc 0.4217, lr 3.000000e-03
2025-12-12 15:31:08,568   INFO  Saved checkpoint to log/ckpt_epoch_5.pth
2025-12-12 15:32:04,570   INFO  epoch 6/20, seq 50/396, total_loss 0.9658, cls 0.5462, loc 0.4195, lr 3.000000e-03
2025-12-12 15:32:56,945   INFO  epoch 6/20, seq 100/396, total_loss 0.8866, cls 0.5058, loc 0.3808, lr 3.000000e-03
2025-12-12 15:33:51,147   INFO  epoch 6/20, seq 150/396, total_loss 1.0286, cls 0.5769, loc 0.4517, lr 3.000000e-03
2025-12-12 15:34:44,544   INFO  epoch 6/20, seq 200/396, total_loss 0.9326, cls 0.4717, loc 0.4609, lr 3.000000e-03
2025-12-12 15:35:37,463   INFO  epoch 6/20, seq 250/396, total_loss 0.8396, cls 0.4689, loc 0.3706, lr 3.000000e-03
2025-12-12 15:36:29,572   INFO  epoch 6/20, seq 300/396, total_loss 0.8854, cls 0.5121, loc 0.3733, lr 3.000000e-03
2025-12-12 15:37:22,845   INFO  epoch 6/20, seq 350/396, total_loss 1.1296, cls 0.6280, loc 0.5016, lr 3.000000e-03
2025-12-12 15:38:11,870   INFO  Saved checkpoint to log/ckpt_epoch_6.pth
2025-12-12 15:39:08,417   INFO  epoch 7/20, seq 50/396, total_loss 0.7728, cls 0.3855, loc 0.3873, lr 3.000000e-03
2025-12-12 15:40:02,177   INFO  epoch 7/20, seq 100/396, total_loss 0.8879, cls 0.4995, loc 0.3884, lr 3.000000e-03
2025-12-12 15:40:54,189   INFO  epoch 7/20, seq 150/396, total_loss 0.9844, cls 0.5435, loc 0.4409, lr 3.000000e-03
2025-12-12 15:41:46,527   INFO  epoch 7/20, seq 200/396, total_loss 0.9546, cls 0.5363, loc 0.4183, lr 3.000000e-03
2025-12-12 15:42:39,198   INFO  epoch 7/20, seq 250/396, total_loss 0.9006, cls 0.4561, loc 0.4445, lr 3.000000e-03
2025-12-12 15:43:32,587   INFO  epoch 7/20, seq 300/396, total_loss 0.8910, cls 0.4902, loc 0.4008, lr 3.000000e-03
2025-12-12 15:44:24,783   INFO  epoch 7/20, seq 350/396, total_loss 0.8873, cls 0.4693, loc 0.4180, lr 3.000000e-03
2025-12-12 15:45:12,064   INFO  Saved checkpoint to log/ckpt_epoch_7.pth
2025-12-12 15:46:06,742   INFO  epoch 8/20, seq 50/396, total_loss 0.6318, cls 0.3293, loc 0.3025, lr 3.000000e-03
2025-12-12 15:46:59,400   INFO  epoch 8/20, seq 100/396, total_loss 0.7784, cls 0.3664, loc 0.4119, lr 3.000000e-03
2025-12-12 15:47:51,708   INFO  epoch 8/20, seq 150/396, total_loss 0.8211, cls 0.3769, loc 0.4443, lr 3.000000e-03
2025-12-12 15:48:44,181   INFO  epoch 8/20, seq 200/396, total_loss 0.7863, cls 0.3797, loc 0.4066, lr 3.000000e-03
2025-12-12 15:49:37,660   INFO  epoch 8/20, seq 250/396, total_loss 0.7428, cls 0.3602, loc 0.3826, lr 3.000000e-03
2025-12-12 15:50:31,198   INFO  epoch 8/20, seq 300/396, total_loss 0.7736, cls 0.3726, loc 0.4010, lr 3.000000e-03
2025-12-12 15:51:23,291   INFO  epoch 8/20, seq 350/396, total_loss 0.8195, cls 0.3864, loc 0.4331, lr 3.000000e-03
2025-12-12 15:52:11,575   INFO  Saved checkpoint to log/ckpt_epoch_8.pth
2025-12-12 15:53:06,969   INFO  epoch 9/20, seq 50/396, total_loss 0.6029, cls 0.3179, loc 0.2850, lr 3.000000e-03
2025-12-12 15:53:59,306   INFO  epoch 9/20, seq 100/396, total_loss 0.7713, cls 0.3995, loc 0.3718, lr 3.000000e-03
2025-12-12 15:54:52,445   INFO  epoch 9/20, seq 150/396, total_loss 0.8848, cls 0.4868, loc 0.3980, lr 3.000000e-03
2025-12-12 15:55:45,236   INFO  epoch 9/20, seq 200/396, total_loss 0.7287, cls 0.4076, loc 0.3211, lr 3.000000e-03
2025-12-12 15:56:38,158   INFO  epoch 9/20, seq 250/396, total_loss 0.7039, cls 0.3680, loc 0.3359, lr 3.000000e-03
2025-12-12 15:57:31,525   INFO  epoch 9/20, seq 300/396, total_loss 0.7500, cls 0.4068, loc 0.3432, lr 3.000000e-03
2025-12-12 15:58:24,049   INFO  epoch 9/20, seq 350/396, total_loss 0.7335, cls 0.3736, loc 0.3599, lr 3.000000e-03
2025-12-12 15:59:13,064   INFO  Saved checkpoint to log/ckpt_epoch_9.pth
2025-12-12 16:00:08,719   INFO  epoch 10/20, seq 50/396, total_loss 0.7133, cls 0.3300, loc 0.3834, lr 3.000000e-03
2025-12-12 16:01:02,448   INFO  epoch 10/20, seq 100/396, total_loss 0.9210, cls 0.4941, loc 0.4269, lr 3.000000e-03
2025-12-12 16:01:54,690   INFO  epoch 10/20, seq 150/396, total_loss 0.6324, cls 0.3176, loc 0.3148, lr 3.000000e-03
2025-12-12 16:02:48,355   INFO  epoch 10/20, seq 200/396, total_loss 0.5732, cls 0.2729, loc 0.3002, lr 3.000000e-03
2025-12-12 16:03:40,546   INFO  epoch 10/20, seq 250/396, total_loss 0.6847, cls 0.3632, loc 0.3214, lr 3.000000e-03
2025-12-12 16:04:31,799   INFO  epoch 10/20, seq 300/396, total_loss 0.9104, cls 0.4640, loc 0.4464, lr 3.000000e-03
2025-12-12 16:05:24,182   INFO  epoch 10/20, seq 350/396, total_loss 0.5942, cls 0.2635, loc 0.3307, lr 3.000000e-03
2025-12-12 16:06:12,228   INFO  Saved checkpoint to log/ckpt_epoch_10.pth
2025-12-12 16:07:08,918   INFO  epoch 11/20, seq 50/396, total_loss 0.7093, cls 0.3955, loc 0.3137, lr 3.000000e-03
2025-12-12 16:08:01,776   INFO  epoch 11/20, seq 100/396, total_loss 0.7013, cls 0.3611, loc 0.3402, lr 3.000000e-03
2025-12-12 16:08:53,630   INFO  epoch 11/20, seq 150/396, total_loss 0.6899, cls 0.3709, loc 0.3190, lr 3.000000e-03
2025-12-12 16:09:45,754   INFO  epoch 11/20, seq 200/396, total_loss 0.5433, cls 0.2648, loc 0.2785, lr 3.000000e-03
2025-12-12 16:10:38,361   INFO  epoch 11/20, seq 250/396, total_loss 0.7369, cls 0.3699, loc 0.3671, lr 3.000000e-03
2025-12-12 16:11:31,531   INFO  epoch 11/20, seq 300/396, total_loss 0.8137, cls 0.4410, loc 0.3727, lr 3.000000e-03
2025-12-12 16:12:23,840   INFO  epoch 11/20, seq 350/396, total_loss 0.8643, cls 0.4669, loc 0.3974, lr 3.000000e-03
2025-12-12 16:13:12,331   INFO  Saved checkpoint to log/ckpt_epoch_11.pth

