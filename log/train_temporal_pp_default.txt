2025-12-19 13:50:23,292   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 13:50:23,292   INFO  seq_len=8, stride=4
2025-12-19 13:50:23,398   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 13:50:23,398   INFO  Database filter by min points truck: 451 => 412
2025-12-19 13:50:23,398   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 13:50:23,398   INFO  Database filter by min points bus: 337 => 309
2025-12-19 13:50:23,398   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 13:50:23,398   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 13:50:23,398   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 13:50:23,398   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 13:50:23,399   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 13:50:23,399   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 13:50:23,399   INFO  Loading NuScenes dataset
2025-12-19 13:50:23,457   INFO  Total samples for NuScenes dataset: 323
2025-12-19 13:50:23,461   INFO  Total samples after balanced resampling: 1630
2025-12-19 13:50:25,364   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 13:55:13,597   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 13:55:13,598   INFO  seq_len=8, stride=4
2025-12-19 13:55:13,649   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 13:55:13,650   INFO  Database filter by min points truck: 451 => 412
2025-12-19 13:55:13,650   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 13:55:13,650   INFO  Database filter by min points bus: 337 => 309
2025-12-19 13:55:13,650   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 13:55:13,650   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 13:55:13,650   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 13:55:13,650   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 13:55:13,650   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 13:55:13,650   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 13:55:13,651   INFO  Loading NuScenes dataset
2025-12-19 13:55:13,665   INFO  Total samples for NuScenes dataset: 323
2025-12-19 13:55:13,667   INFO  Total samples after balanced resampling: 1630
2025-12-19 13:55:15,103   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 13:55:53,927   INFO  epoch 1/20, seq 50/395, total_loss 2.7797, cls 1.0967, loc 1.6426, aux 0.4036, lr 3.000000e-03
2025-12-19 13:56:05,480   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 13:56:05,480   INFO  seq_len=8, stride=4
2025-12-19 13:56:05,534   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 13:56:05,534   INFO  Database filter by min points truck: 451 => 412
2025-12-19 13:56:05,534   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 13:56:05,534   INFO  Database filter by min points bus: 337 => 309
2025-12-19 13:56:05,534   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 13:56:05,535   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 13:56:05,535   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 13:56:05,535   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 13:56:05,535   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 13:56:05,535   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 13:56:05,536   INFO  Loading NuScenes dataset
2025-12-19 13:56:05,550   INFO  Total samples for NuScenes dataset: 323
2025-12-19 13:56:05,552   INFO  Total samples after balanced resampling: 1630
2025-12-19 13:56:06,992   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 13:56:47,038   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 13:56:47,038   INFO  seq_len=8, stride=4
2025-12-19 13:56:47,093   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 13:56:47,093   INFO  Database filter by min points truck: 451 => 412
2025-12-19 13:56:47,093   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 13:56:47,093   INFO  Database filter by min points bus: 337 => 309
2025-12-19 13:56:47,093   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 13:56:47,094   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 13:56:47,094   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 13:56:47,094   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 13:56:47,094   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 13:56:47,094   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 13:56:47,095   INFO  Loading NuScenes dataset
2025-12-19 13:56:47,109   INFO  Total samples for NuScenes dataset: 323
2025-12-19 13:56:47,112   INFO  Total samples after balanced resampling: 1630
2025-12-19 13:56:48,600   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 13:57:26,179   INFO  epoch 1/20, seq 50/396, total_loss 1.8833, cls 1.0646, loc 0.7692, aux 0.4947, lr 3.000000e-03
2025-12-19 13:57:59,992   INFO  epoch 1/20, seq 100/396, total_loss 1.6886, cls 0.9177, loc 0.7389, aux 0.3197, lr 3.000000e-03
2025-12-19 13:58:33,661   INFO  epoch 1/20, seq 150/396, total_loss 1.6004, cls 0.8443, loc 0.7286, aux 0.2741, lr 3.000000e-03
2025-12-19 13:59:07,284   INFO  epoch 1/20, seq 200/396, total_loss 1.5442, cls 0.8393, loc 0.6770, aux 0.2785, lr 3.000000e-03
2025-12-19 13:59:39,761   INFO  epoch 1/20, seq 250/396, total_loss 1.5810, cls 0.8527, loc 0.7071, aux 0.2108, lr 3.000000e-03
2025-12-19 14:00:13,247   INFO  epoch 1/20, seq 300/396, total_loss 1.6433, cls 0.9192, loc 0.7042, aux 0.1983, lr 3.000000e-03
2025-12-19 14:00:47,279   INFO  epoch 1/20, seq 350/396, total_loss 1.4915, cls 0.8353, loc 0.6335, aux 0.2276, lr 3.000000e-03
2025-12-19 14:01:17,710   INFO  Saved checkpoint to log/ckpt_epoch_1.pth
2025-12-19 14:01:54,541   INFO  epoch 2/20, seq 50/396, total_loss 1.5028, cls 0.8397, loc 0.6433, aux 0.1981, lr 3.000000e-03
2025-12-19 14:02:27,545   INFO  epoch 2/20, seq 100/396, total_loss 1.5299, cls 0.8787, loc 0.6296, aux 0.2160, lr 3.000000e-03
2025-12-19 14:03:01,482   INFO  epoch 2/20, seq 150/396, total_loss 1.4365, cls 0.8166, loc 0.5897, aux 0.3020, lr 3.000000e-03
2025-12-19 14:03:34,762   INFO  epoch 2/20, seq 200/396, total_loss 1.4653, cls 0.8454, loc 0.5992, aux 0.2075, lr 3.000000e-03
2025-12-19 14:04:07,176   INFO  epoch 2/20, seq 250/396, total_loss 1.4532, cls 0.8232, loc 0.6062, aux 0.2386, lr 3.000000e-03
2025-12-19 14:04:41,758   INFO  epoch 2/20, seq 300/396, total_loss 1.4330, cls 0.8168, loc 0.5901, aux 0.2612, lr 3.000000e-03
2025-12-19 14:05:16,146   INFO  epoch 2/20, seq 350/396, total_loss 1.4308, cls 0.7901, loc 0.6206, aux 0.2007, lr 3.000000e-03
2025-12-19 14:05:47,526   INFO  Saved checkpoint to log/ckpt_epoch_2.pth
2025-12-19 14:06:24,878   INFO  epoch 3/20, seq 50/396, total_loss 1.5090, cls 0.8114, loc 0.6712, aux 0.2635, lr 3.000000e-03
2025-12-19 14:06:59,713   INFO  epoch 3/20, seq 100/396, total_loss 1.4157, cls 0.8157, loc 0.5729, aux 0.2703, lr 3.000000e-03
2025-12-19 14:07:34,083   INFO  epoch 3/20, seq 150/396, total_loss 1.4345, cls 0.8268, loc 0.5880, aux 0.1972, lr 3.000000e-03
2025-12-19 14:08:08,967   INFO  epoch 3/20, seq 200/396, total_loss 1.4828, cls 0.8033, loc 0.6581, aux 0.2142, lr 3.000000e-03
2025-12-19 14:08:43,661   INFO  epoch 3/20, seq 250/396, total_loss 1.4378, cls 0.7850, loc 0.6334, aux 0.1945, lr 3.000000e-03
2025-12-19 14:09:18,924   INFO  epoch 3/20, seq 300/396, total_loss 1.4042, cls 0.7959, loc 0.5851, aux 0.2318, lr 3.000000e-03
2025-12-19 14:09:53,081   INFO  epoch 3/20, seq 350/396, total_loss 1.2319, cls 0.6700, loc 0.5394, aux 0.2247, lr 3.000000e-03
2025-12-19 14:10:24,880   INFO  Saved checkpoint to log/ckpt_epoch_3.pth
2025-12-19 14:11:02,920   INFO  epoch 4/20, seq 50/396, total_loss 1.4014, cls 0.7815, loc 0.6025, aux 0.1735, lr 3.000000e-03
2025-12-19 14:11:38,699   INFO  epoch 4/20, seq 100/396, total_loss 1.3487, cls 0.7648, loc 0.5585, aux 0.2538, lr 3.000000e-03
2025-12-19 14:12:13,935   INFO  epoch 4/20, seq 150/396, total_loss 1.3979, cls 0.7716, loc 0.6075, aux 0.1881, lr 3.000000e-03
2025-12-19 14:12:50,039   INFO  epoch 4/20, seq 200/396, total_loss 1.3345, cls 0.7405, loc 0.5738, aux 0.2012, lr 3.000000e-03
2025-12-19 14:13:25,297   INFO  epoch 4/20, seq 250/396, total_loss 1.3476, cls 0.7212, loc 0.6077, aux 0.1865, lr 3.000000e-03
2025-12-19 14:14:01,875   INFO  epoch 4/20, seq 300/396, total_loss 1.3966, cls 0.7515, loc 0.6237, aux 0.2150, lr 3.000000e-03
2025-12-19 14:14:37,265   INFO  epoch 4/20, seq 350/396, total_loss 1.2866, cls 0.6521, loc 0.6157, aux 0.1874, lr 3.000000e-03
2025-12-19 14:15:09,547   INFO  Saved checkpoint to log/ckpt_epoch_4.pth
2025-12-19 14:15:48,841   INFO  epoch 5/20, seq 50/396, total_loss 1.2923, cls 0.6742, loc 0.5986, aux 0.1943, lr 3.000000e-03
2025-12-19 14:16:25,094   INFO  epoch 5/20, seq 100/396, total_loss 1.2831, cls 0.6475, loc 0.6178, aux 0.1780, lr 3.000000e-03
2025-12-19 14:17:02,090   INFO  epoch 5/20, seq 150/396, total_loss 1.0539, cls 0.5446, loc 0.4887, aux 0.2059, lr 3.000000e-03
2025-12-19 14:17:39,161   INFO  epoch 5/20, seq 200/396, total_loss 1.1848, cls 0.6402, loc 0.5231, aux 0.2142, lr 3.000000e-03
2025-12-19 14:18:15,912   INFO  epoch 5/20, seq 250/396, total_loss 1.1879, cls 0.6606, loc 0.5086, aux 0.1864, lr 3.000000e-03
2025-12-19 14:18:52,128   INFO  epoch 5/20, seq 300/396, total_loss 1.3326, cls 0.6902, loc 0.6222, aux 0.2027, lr 3.000000e-03
2025-12-19 14:19:28,542   INFO  epoch 5/20, seq 350/396, total_loss 1.2725, cls 0.6828, loc 0.5621, aux 0.2751, lr 3.000000e-03
2025-12-19 14:20:01,066   INFO  Saved checkpoint to log/ckpt_epoch_5.pth
2025-12-19 14:20:41,825   INFO  epoch 6/20, seq 50/396, total_loss 1.2330, cls 0.6654, loc 0.5429, aux 0.2476, lr 3.000000e-03
2025-12-19 14:21:19,389   INFO  epoch 6/20, seq 100/396, total_loss 1.0974, cls 0.5397, loc 0.5380, aux 0.1967, lr 3.000000e-03
2025-12-19 14:21:57,025   INFO  epoch 6/20, seq 150/396, total_loss 1.0911, cls 0.5670, loc 0.4969, aux 0.2708, lr 3.000000e-03
2025-12-19 14:22:34,670   INFO  epoch 6/20, seq 200/396, total_loss 1.1996, cls 0.6116, loc 0.5620, aux 0.2603, lr 3.000000e-03
2025-12-19 14:23:12,345   INFO  epoch 6/20, seq 250/396, total_loss 0.8899, cls 0.4562, loc 0.4147, aux 0.1903, lr 3.000000e-03
2025-12-19 14:23:50,125   INFO  epoch 6/20, seq 300/396, total_loss 0.8656, cls 0.4194, loc 0.4247, aux 0.2155, lr 3.000000e-03
2025-12-19 14:24:26,647   INFO  epoch 6/20, seq 350/396, total_loss 1.0359, cls 0.5502, loc 0.4556, aux 0.3012, lr 3.000000e-03
2025-12-19 14:24:59,555   INFO  Saved checkpoint to log/ckpt_epoch_6.pth
2025-12-19 14:25:39,375   INFO  epoch 7/20, seq 50/396, total_loss 1.1200, cls 0.5619, loc 0.5388, aux 0.1926, lr 3.000000e-03
2025-12-19 14:26:15,375   INFO  epoch 7/20, seq 100/396, total_loss 0.9524, cls 0.4439, loc 0.4908, aux 0.1778, lr 3.000000e-03
2025-12-19 14:26:52,555   INFO  epoch 7/20, seq 150/396, total_loss 1.1726, cls 0.6106, loc 0.5354, aux 0.2656, lr 3.000000e-03
2025-12-19 14:27:30,021   INFO  epoch 7/20, seq 200/396, total_loss 1.1245, cls 0.5434, loc 0.5620, aux 0.1907, lr 3.000000e-03
2025-12-19 14:28:07,691   INFO  epoch 7/20, seq 250/396, total_loss 1.2519, cls 0.6369, loc 0.5967, aux 0.1830, lr 3.000000e-03
2025-12-19 14:28:45,057   INFO  epoch 7/20, seq 300/396, total_loss 0.9904, cls 0.5248, loc 0.4394, aux 0.2623, lr 3.000000e-03
2025-12-19 14:29:22,912   INFO  epoch 7/20, seq 350/396, total_loss 1.1773, cls 0.5993, loc 0.5543, aux 0.2373, lr 3.000000e-03
2025-12-19 14:29:57,194   INFO  Saved checkpoint to log/ckpt_epoch_7.pth
2025-12-19 14:30:38,043   INFO  epoch 8/20, seq 50/396, total_loss 1.1818, cls 0.5887, loc 0.5729, aux 0.2025, lr 3.000000e-03
2025-12-19 14:31:15,212   INFO  epoch 8/20, seq 100/396, total_loss 0.9820, cls 0.5102, loc 0.4490, aux 0.2275, lr 3.000000e-03
2025-12-19 14:31:52,600   INFO  epoch 8/20, seq 150/396, total_loss 1.1028, cls 0.5235, loc 0.5601, aux 0.1914, lr 3.000000e-03
2025-12-19 14:32:29,222   INFO  epoch 8/20, seq 200/396, total_loss 0.8608, cls 0.3972, loc 0.4410, aux 0.2265, lr 3.000000e-03
2025-12-19 14:33:07,017   INFO  epoch 8/20, seq 250/396, total_loss 1.1068, cls 0.5936, loc 0.4844, aux 0.2876, lr 3.000000e-03
2025-12-19 14:33:44,517   INFO  epoch 8/20, seq 300/396, total_loss 0.8159, cls 0.3741, loc 0.4194, aux 0.2234, lr 3.000000e-03
2025-12-19 16:12:42,611   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 16:12:42,611   INFO  seq_len=8, stride=4
2025-12-19 16:12:42,665   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 16:12:42,665   INFO  Database filter by min points truck: 451 => 412
2025-12-19 16:12:42,665   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 16:12:42,665   INFO  Database filter by min points bus: 337 => 309
2025-12-19 16:12:42,665   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 16:12:42,665   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 16:12:42,665   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 16:12:42,665   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 16:12:42,665   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 16:12:42,666   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 16:12:42,666   INFO  Loading NuScenes dataset
2025-12-19 16:12:42,680   INFO  Total samples for NuScenes dataset: 323
2025-12-19 16:12:42,683   INFO  Total samples after balanced resampling: 1630
2025-12-19 16:12:44,135   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 16:14:39,715   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 16:14:39,715   INFO  seq_len=8, stride=4
2025-12-19 16:14:39,766   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 16:14:39,766   INFO  Database filter by min points truck: 451 => 412
2025-12-19 16:14:39,767   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 16:14:39,767   INFO  Database filter by min points bus: 337 => 309
2025-12-19 16:14:39,767   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 16:14:39,767   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 16:14:39,767   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 16:14:39,767   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 16:14:39,767   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 16:14:39,767   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 16:14:39,768   INFO  Loading NuScenes dataset
2025-12-19 16:14:39,782   INFO  Total samples for NuScenes dataset: 323
2025-12-19 16:14:39,784   INFO  Total samples after balanced resampling: 1630
2025-12-19 16:14:41,225   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 16:17:24,778   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 16:17:24,778   INFO  seq_len=8, stride=4
2025-12-19 16:17:24,840   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 16:17:24,840   INFO  Database filter by min points truck: 451 => 412
2025-12-19 16:17:24,840   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 16:17:24,840   INFO  Database filter by min points bus: 337 => 309
2025-12-19 16:17:24,840   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 16:17:24,840   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 16:17:24,840   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 16:17:24,841   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 16:17:24,841   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 16:17:24,841   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 16:17:24,841   INFO  Loading NuScenes dataset
2025-12-19 16:17:24,856   INFO  Total samples for NuScenes dataset: 323
2025-12-19 16:17:24,859   INFO  Total samples after balanced resampling: 1630
2025-12-19 16:17:26,319   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 16:20:11,808   INFO  {'ROOT_DIR': PosixPath('/home/cernanskyr/OpenPCDet'), 'LOCAL_RANK': 0, 'CLASS_NAMES': ['car', 'truck', 'construction_vehicle', 'bus', 'trailer', 'barrier', 'motorcycle', 'bicycle', 'pedestrian', 'traffic_cone'], 'DATA_CONFIG': {'DATASET': 'NuScenesDataset', 'DATA_PATH': '/home/cernanskyr/OpenPCDet/data/nuscenes', 'VERSION': 'v1.0-mini', 'MAX_SWEEPS': 10, 'PRED_VELOCITY': True, 'SET_NAN_VELOCITY_TO_ZEROS': True, 'FILTER_MIN_POINTS_IN_GT': 1, 'DATA_SPLIT': {'train': 'train', 'test': 'val'}, 'INFO_PATH': {'train': ['nuscenes_infos_10sweeps_train.pkl'], 'test': ['nuscenes_infos_10sweeps_val.pkl']}, 'POINT_CLOUD_RANGE': [-51.2, -51.2, -5.0, 51.2, 51.2, 3.0], 'BALANCED_RESAMPLING': True, 'DATA_AUGMENTOR': {'DISABLE_AUG_LIST': ['placeholder'], 'AUG_CONFIG_LIST': [{'NAME': 'gt_sampling', 'DB_INFO_PATH': ['nuscenes_dbinfos_10sweeps_withvelo.pkl'], 'PREPARE': {'filter_by_min_points': ['car:5', 'truck:5', 'construction_vehicle:5', 'bus:5', 'trailer:5', 'barrier:5', 'motorcycle:5', 'bicycle:5', 'pedestrian:5', 'traffic_cone:5']}, 'SAMPLE_GROUPS': ['car:2', 'truck:3', 'construction_vehicle:7', 'bus:4', 'trailer:6', 'barrier:2', 'motorcycle:6', 'bicycle:6', 'pedestrian:2', 'traffic_cone:2'], 'NUM_POINT_FEATURES': 5, 'DATABASE_WITH_FAKELIDAR': False, 'REMOVE_EXTRA_WIDTH': [0.0, 0.0, 0.0], 'LIMIT_WHOLE_SCENE': True}, {'NAME': 'random_world_flip', 'ALONG_AXIS_LIST': ['x', 'y']}, {'NAME': 'random_world_rotation', 'WORLD_ROT_ANGLE': [-0.3925, 0.3925]}, {'NAME': 'random_world_scaling', 'WORLD_SCALE_RANGE': [0.95, 1.05]}]}, 'POINT_FEATURE_ENCODING': {'encoding_type': 'absolute_coordinates_encoding', 'used_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp'], 'src_feature_list': ['x', 'y', 'z', 'intensity', 'timestamp']}, 'DATA_PROCESSOR': [{'NAME': 'mask_points_and_boxes_outside_range', 'REMOVE_OUTSIDE_BOXES': True}, {'NAME': 'shuffle_points', 'SHUFFLE_ENABLED': {'train': True, 'test': True}}, {'NAME': 'transform_points_to_voxels', 'VOXEL_SIZE': [0.2, 0.2, 8.0], 'MAX_POINTS_PER_VOXEL': 20, 'MAX_NUMBER_OF_VOXELS': {'train': 30000, 'test': 30000}}], '_BASE_CONFIG_': 'xmem_det/configs/nuscenes_dataset.yaml'}, 'MODEL': {'NAME': 'PointPillar', 'VFE': {'NAME': 'PillarVFE', 'WITH_DISTANCE': False, 'USE_ABSLOTE_XYZ': True, 'USE_NORM': True, 'NUM_FILTERS': [64]}, 'MAP_TO_BEV': {'NAME': 'PointPillarScatter', 'NUM_BEV_FEATURES': 64}, 'BACKBONE_2D': {'NAME': 'BaseBEVBackbone', 'LAYER_NUMS': [3, 5, 5], 'LAYER_STRIDES': [2, 2, 2], 'NUM_FILTERS': [64, 128, 256], 'UPSAMPLE_STRIDES': [0.5, 1, 2], 'NUM_UPSAMPLE_FILTERS': [128, 128, 128]}, 'DENSE_HEAD': {'NAME': 'AnchorHeadMulti', 'CLASS_AGNOSTIC': False, 'DIR_OFFSET': 0.78539, 'DIR_LIMIT_OFFSET': 0.0, 'NUM_DIR_BINS': 2, 'USE_MULTIHEAD': True, 'SEPARATE_MULTIHEAD': True, 'ANCHOR_GENERATOR_CONFIG': [{'class_name': 'car', 'anchor_sizes': [[4.63, 1.97, 1.74]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.95], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.45}, {'class_name': 'truck', 'anchor_sizes': [[6.93, 2.51, 2.84]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.6], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'construction_vehicle', 'anchor_sizes': [[6.37, 2.85, 3.19]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.225], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'bus', 'anchor_sizes': [[10.5, 2.94, 3.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'trailer', 'anchor_sizes': [[12.29, 2.9, 3.87]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [0.115], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'barrier', 'anchor_sizes': [[0.5, 2.53, 0.98]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.33], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.55, 'unmatched_threshold': 0.4}, {'class_name': 'motorcycle', 'anchor_sizes': [[2.11, 0.77, 1.47]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.085], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.3}, {'class_name': 'bicycle', 'anchor_sizes': [[1.7, 0.6, 1.28]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.18], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.5, 'unmatched_threshold': 0.35}, {'class_name': 'pedestrian', 'anchor_sizes': [[0.73, 0.67, 1.77]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-0.935], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}, {'class_name': 'traffic_cone', 'anchor_sizes': [[0.41, 0.41, 1.07]], 'anchor_rotations': [0, 1.57], 'anchor_bottom_heights': [-1.285], 'align_center': False, 'feature_map_stride': 4, 'matched_threshold': 0.6, 'unmatched_threshold': 0.4}], 'SHARED_CONV_NUM_FILTER': 64, 'RPN_HEAD_CFGS': [{'HEAD_CLS_NAME': ['car']}, {'HEAD_CLS_NAME': ['truck', 'construction_vehicle']}, {'HEAD_CLS_NAME': ['bus', 'trailer']}, {'HEAD_CLS_NAME': ['barrier']}, {'HEAD_CLS_NAME': ['motorcycle', 'bicycle']}, {'HEAD_CLS_NAME': ['pedestrian', 'traffic_cone']}], 'SEPARATE_REG_CONFIG': {'NUM_MIDDLE_CONV': 1, 'NUM_MIDDLE_FILTER': 64, 'REG_LIST': ['reg:2', 'height:1', 'size:3', 'angle:2', 'velo:2']}, 'TARGET_ASSIGNER_CONFIG': {'NAME': 'AxisAlignedTargetAssigner', 'POS_FRACTION': -1.0, 'SAMPLE_SIZE': 512, 'NORM_BY_NUM_EXAMPLES': False, 'MATCH_HEIGHT': False, 'BOX_CODER': 'ResidualCoder', 'BOX_CODER_CONFIG': {'code_size': 9, 'encode_angle_by_sincos': True}}, 'LOSS_CONFIG': {'REG_LOSS_TYPE': 'WeightedL1Loss', 'LOSS_WEIGHTS': {'pos_cls_weight': 1.0, 'neg_cls_weight': 2.0, 'cls_weight': 1.0, 'loc_weight': 0.25, 'dir_weight': 0.2, 'code_weights': [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.2, 0.2]}}}, 'POST_PROCESSING': {'RECALL_THRESH_LIST': [0.3, 0.5, 0.7], 'SCORE_THRESH': 0.1, 'OUTPUT_RAW_SCORE': False, 'EVAL_METRIC': 'kitti', 'NMS_CONFIG': {'MULTI_CLASSES_NMS': True, 'NMS_TYPE': 'nms_gpu', 'NMS_THRESH': 0.2, 'NMS_PRE_MAXSIZE': 1000, 'NMS_POST_MAXSIZE': 83}}}, 'OPTIMIZATION': {'BATCH_SIZE_PER_GPU': 1, 'NUM_EPOCHS': 20, 'NUM_WORKERS': 4, 'LR': 0.003, 'WEIGHT_DECAY': 0.01, 'MOMENTUM': 0.9}, 'TRAIN': {'SEQ_LEN': 8, 'STRIDE': 4, 'VAL_EVAL_INTERVAL': 1, 'LOG_INTERVAL': 50}, 'TEST': {'SPLIT': 'val'}}
2025-12-19 16:20:11,808   INFO  seq_len=8, stride=4
2025-12-19 16:20:11,870   INFO  Database filter by min points car: 4082 => 3303
2025-12-19 16:20:11,871   INFO  Database filter by min points truck: 451 => 412
2025-12-19 16:20:11,871   INFO  Database filter by min points construction_vehicle: 174 => 161
2025-12-19 16:20:11,871   INFO  Database filter by min points bus: 337 => 309
2025-12-19 16:20:11,871   INFO  Database filter by min points trailer: 59 => 57
2025-12-19 16:20:11,871   INFO  Database filter by min points barrier: 1851 => 1741
2025-12-19 16:20:11,871   INFO  Database filter by min points motorcycle: 179 => 149
2025-12-19 16:20:11,871   INFO  Database filter by min points bicycle: 147 => 136
2025-12-19 16:20:11,871   INFO  Database filter by min points pedestrian: 3068 => 2799
2025-12-19 16:20:11,871   INFO  Database filter by min points traffic_cone: 773 => 635
2025-12-19 16:20:11,872   INFO  Loading NuScenes dataset
2025-12-19 16:20:11,887   INFO  Total samples for NuScenes dataset: 323
2025-12-19 16:20:11,889   INFO  Total samples after balanced resampling: 1630
2025-12-19 16:20:13,326   INFO  Start training temporal PointPillar with cyclical XMem gating
2025-12-19 16:20:13,328   INFO  Epoch 1/23 stage=stage1 alpha=0.000
2025-12-19 16:21:04,340   INFO  epoch 1/23, seq 50/398, total_loss 6.4679, cls 1.1459, loc 5.2798, aux 0.4223, lr 3.000000e-03
2025-12-19 16:21:48,888   INFO  epoch 1/23, seq 100/398, total_loss 5.9651, cls 1.1504, loc 4.7844, aux 0.3036, lr 3.000000e-03
